{% extends "base.html" %}

{% block content %}

<h2>Tabela FACTURA</h2>

<form action="/factura/add" method="post" class="form-table">

<div class="form-group">
<label>ID</label>
<input name="id" required>
</div>

<div class="form-group">
<label>Ofertă</label>
<select name="oferta">
<option value="">opțional</option>
{% for o in oferte %}
<option value="{{o[0]}}">
{{o[0]}} - {{o[1]}} lei
</option>
{% endfor %}
</select>
</div>

<div class="form-group">
<label>Client</label>
<select name="client">
<option value="">opțional</option>
{% for c in clienti %}
<option value="{{c[0]}}">
{{c[1]}} {{c[2]}}
</option>
{% endfor %}
</select>
</div>

<div class="form-group">
<label>Lucrare</label>
<select name="lucrare" required>
{% for l in lucrari %}
<option value="{{l[0]}}">
{{l[1]}}
</option>
{% endfor %}
</select>
</div>

<div class="form-group">
<label>Dată facturare</label>
<input type="date" name="data" required>
</div>

<div class="form-actions">
<button type="submit" class="btn-primary">
Adaugă
</button>
</div>

</form>


<hr>
<div class="table-wrapper">
<table border="1">
<tr>
<th>ID</th>
<th>Ofertă</th>
<th>Client</th>
<th>Lucrare</th>
<th>Dată facturare</th>
<th>Acțiuni</th>
</tr>

{% for f in facturi %}
<tr>
<form action="/factura/update/{{f[0]}}" method="post">

<td>{{f[0]}}</td>

<td>
<select name="oferta">
<option value="">-- optional --</option>
{% for o in oferte %}
<option value="{{o[0]}}"
{% if o[0]==f[1] %} selected {% endif %}>
{{o[0]}} - {{o[1]}} lei
</option>
{% endfor %}
</select>
</td>

<td>
<select name="client">
<option value="">-- optional --</option>
{% for c in clienti %}
<option value="{{c[0]}}"
{% if c[0]==f[3] %} selected {% endif %}>
{{c[1]}} {{c[2]}}
</option>
{% endfor %}
</select>
</td>

<td>
<select name="lucrare">
{% for l in lucrari %}
<option value="{{l[0]}}"
{% if l[0]==f[6] %} selected {% endif %}>
{{l[1]}}
</option>
{% endfor %}
</select>
</td>

<td>
<input type="date" name="data" value="{{f[8].strftime('%Y-%m-%d')}}">
</td>

<td>
<div class="action-buttons">

<form action="/factura/update/{{f[0]}}" method="post">
    <button type="submit" class="btn-primary small">
        Actualizează
    </button>
</form>

<form action="/factura/delete/{{f[0]}}" method="post">
    <button type="submit" class="btn-danger small">
        Șterge
    </button>
</form>

</div>
</td>

</form>
</tr>
{% endfor %}
</table>
</div>
{% endblock %}